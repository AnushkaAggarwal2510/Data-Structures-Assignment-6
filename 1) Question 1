Question 1) Develop a menu driven program for the following operations of on a Circular as well as a Doubly Linked List.
(a) Insertion anywhere in the linked list (As a first node, as a last node, and
after/before a specific node).
(b) Deletion of a specific node, say 'Delete Node 60'. That mean the node to be
deleted may appear as a head node, last node or a node in between.
(c) Search for a node.

Answer 1)

#include <iostream>
using namespace std;

struct CNode {
    int data;
    CNode* next;
};

class CircularList {
    CNode* head;

public:
    CircularList() { head = NULL; }

    void insertBegin(int val) {
        CNode* newNode = new CNode{val, NULL};
        if (!head) {
            head = newNode;
            newNode->next = head;
        } else {
            CNode* temp = head;
            while (temp->next != head) temp = temp->next;
            newNode->next = head;
            temp->next = newNode;
            head = newNode;
        }
    }
    void insertEnd(int val) {
        CNode* newNode = new CNode{val, NULL};
        if (!head) {
            head = newNode;
            newNode->next = head;
        } else {
            CNode* temp = head;
            while (temp->next != head) temp = temp->next;
            temp->next = newNode;
            newNode->next = head;
        }
    }
    void insertAfter(int key, int val) {
        if (!head) { cout << "List empty!\n"; return; }

        CNode* temp = head;
        do {
            if (temp->data == key) {
                CNode* newNode = new CNode{val, temp->next};
                temp->next = newNode;
                return;
            }
            temp = temp->next;
        } while (temp != head);

        cout << "Value not found!\n";
    }
    void deleteNode(int key) {
        if (!head) { cout << "List empty!\n"; return; }

        CNode* curr = head;
        CNode* prev = NULL;

        if (head->data == key) {
            CNode* temp = head;
            while (temp->next != head) temp = temp->next;
            if (temp == head) { // Only one node
                delete head;
                head = NULL;
                return;
            }
            temp->next = head->next;
            head = head->next;
            delete curr;
            return;
        }
        do {
            prev = curr;
            curr = curr->next;
        } while (curr != head && curr->data != key);

        if (curr->data == key) {
            prev->next = curr->next;
            delete curr;
        } else {
            cout << "Value not found!\n";
        }
    }
    void search(int key) {
        if (!head) { cout << "List empty!\n"; return; }

        CNode* temp = head;
        do {
            if (temp->data == key) {
                cout << "Found!\n";
                return;
            }
            temp = temp->next;
        } while (temp != head);

        cout << "Not found!\n";
    }

    void display() {
        if (!head) { cout << "List empty!\n"; return; }

        CNode* temp = head;
        cout << "Circular List: ";
        do {
            cout << temp->data << " ";
            temp = temp->next;
        } while (temp != head);

        cout << endl;
    }
};

struct DNode {
    int data;
    DNode* next;
    DNode* prev;
};

class DoublyList {
    DNode* head;

public:
    DoublyList() { head = NULL; }

    void insertBegin(int val) {
        DNode* newNode = new DNode{val, head, NULL};
        if (head) head->prev = newNode;
        head = newNode;
    }

    void insertEnd(int val) {
        DNode* newNode = new DNode{val, NULL, NULL};
        if (!head) {
            head = newNode;
        } else {
            DNode* temp = head;
            while (temp->next) temp = temp->next;
            temp->next = newNode;
            newNode->prev = temp;
        }
    }

    void insertAfter(int key, int val) {
        DNode* temp = head;
        while (temp && temp->data != key) temp = temp->next;

        if (!temp) { cout << "Value not found!\n"; return; }

        DNode* newNode = new DNode{val, temp->next, temp};
        if (temp->next) temp->next->prev = newNode;
        temp->next = newNode;
    }

    void deleteNode(int key) {
        if (!head) { cout << "List empty!\n"; return; }

        DNode* temp = head;

        while (temp && temp->data != key) temp = temp->next;

        if (!temp) { cout << "Value not found!\n"; return; }

        if (temp->prev) temp->prev->next = temp->next;
        else head = temp->next; // Deleting head

        if (temp->next) temp->next->prev = temp->prev;

        delete temp;
    }

    void search(int key) {
        DNode* temp = head;
        while (temp) {
            if (temp->data == key) {
                cout << "Found!\n";
                return;
            }
            temp = temp->next;
        }
        cout << "Not found!\n";
    }

    void display() {
        DNode* temp = head;
        cout << "Doubly List: ";
        while (temp) {
            cout << temp->data << " ";
            temp = temp->next;
        }
        cout << endl;
    }
};

int main() {
    CircularList cl;
    DoublyList dl;
    int choice, type, val, key;

    while (true) {
        cout << "\n--- MENU ---\n";
        cout << "1. Circular Linked List\n";
        cout << "2. Doubly Linked List\n";
        cout << "3. Exit\n";
        cout << "Enter choice: ";
        cin >> choice;

        if (choice == 3) break;

        cout << "1.Insert Begin  2.Insert End  3.Insert After\n";
        cout << "4.Delete Node   5.Search      6.Display\n";
        cout << "Enter operation: ";
        cin >> type;

        switch (choice) {
        case 1: // Circular
            if (type == 1) { cout << "Value: "; cin >> val; cl.insertBegin(val); }
            else if (type == 2) { cout << "Value: "; cin >> val; cl.insertEnd(val); }
            else if (type == 3) { cout << "After which value? "; cin >> key; cout << "Insert value: "; cin >> val; cl.insertAfter(key, val); }
            else if (type == 4) { cout << "Delete value: "; cin >> key; cl.deleteNode(key); }
            else if (type == 5) { cout << "Search value: "; cin >> key; cl.search(key); }
            else if (type == 6) cl.display();
            break;

        case 2: // Doubly
            if (type == 1) { cout << "Value: "; cin >> val; dl.insertBegin(val); }
            else if (type == 2) { cout << "Value: "; cin >> val; dl.insertEnd(val); }
            else if (type == 3) { cout << "After which value? "; cin >> key; cout << "Insert value: "; cin >> val; dl.insertAfter(key, val); }
            else if (type == 4) { cout << "Delete value: "; cin >> key; dl.deleteNode(key); }
            else if (type == 5) { cout << "Search value: "; cin >> key; dl.search(key); }
            else if (type == 6) dl.display();
            break;
        }
    }

    return 0;
}
